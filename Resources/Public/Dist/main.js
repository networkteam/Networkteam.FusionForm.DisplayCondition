(()=>{var T=Object.create;var E=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty;var I=(o,s)=>()=>(s||o((s={exports:{}}).exports,s),s.exports);var G=(o,s,e,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let p of H(s))!V.call(o,p)&&p!==e&&E(o,p,{get:()=>s[p],enumerable:!(r=z(s,p))||r.enumerable});return o};var w=(o,s,e)=>(e=o!=null?T(J(o)):{},G(s||!o||!o.__esModule?E(e,"default",{value:o,enumerable:!0}):e,o));var C=I((R,x)=>{(function(o,s){typeof x=="object"&&x.exports?x.exports=s():o.nearley=s()})(R,function(){function o(t,n,i){return this.id=++o.highestId,this.name=t,this.symbols=n,this.postprocess=i,this}o.highestId=0,o.prototype.toString=function(t){var n=typeof t>"u"?this.symbols.map(v).join(" "):this.symbols.slice(0,t).map(v).join(" ")+" \u25CF "+this.symbols.slice(t).map(v).join(" ");return this.name+" \u2192 "+n};function s(t,n,i,a){this.rule=t,this.dot=n,this.reference=i,this.data=[],this.wantedBy=a,this.isComplete=this.dot===t.symbols.length}s.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},s.prototype.nextState=function(t){var n=new s(this.rule,this.dot+1,this.reference,this.wantedBy);return n.left=this,n.right=t,n.isComplete&&(n.data=n.build(),n.right=void 0),n},s.prototype.build=function(){var t=[],n=this;do t.push(n.right.data),n=n.left;while(n.left);return t.reverse(),t},s.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,c.fail))};function e(t,n){this.grammar=t,this.index=n,this.states=[],this.wants={},this.scannable=[],this.completed={}}e.prototype.process=function(t){for(var n=this.states,i=this.wants,a=this.completed,u=0;u<n.length;u++){var l=n[u];if(l.isComplete){if(l.finish(),l.data!==c.fail){for(var h=l.wantedBy,f=h.length;f--;){var d=h[f];this.complete(d,l)}if(l.reference===this.index){var m=l.rule.name;(this.completed[m]=this.completed[m]||[]).push(l)}}}else{var m=l.rule.symbols[l.dot];if(typeof m!="string"){this.scannable.push(l);continue}if(i[m]){if(i[m].push(l),a.hasOwnProperty(m))for(var y=a[m],f=0;f<y.length;f++){var $=y[f];this.complete(l,$)}}else i[m]=[l],this.predict(m)}}},e.prototype.predict=function(t){for(var n=this.grammar.byName[t]||[],i=0;i<n.length;i++){var a=n[i],u=this.wants[t],l=new s(a,0,this.index,u);this.states.push(l)}},e.prototype.complete=function(t,n){var i=t.nextState(n);this.states.push(i)};function r(t,n){this.rules=t,this.start=n||this.rules[0].name;var i=this.byName={};this.rules.forEach(function(a){i.hasOwnProperty(a.name)||(i[a.name]=[]),i[a.name].push(a)})}r.fromCompiled=function(a,n){var i=a.Lexer;a.ParserStart&&(n=a.ParserStart,a=a.ParserRules);var a=a.map(function(l){return new o(l.name,l.symbols,l.postprocess)}),u=new r(a,n);return u.lexer=i,u};function p(){this.reset("")}p.prototype.reset=function(t,n){this.buffer=t,this.index=0,this.line=n?n.line:1,this.lastLineBreak=n?-n.col:0},p.prototype.next=function(){if(this.index<this.buffer.length){var t=this.buffer[this.index++];return t===`
`&&(this.line+=1,this.lastLineBreak=this.index),{value:t}}},p.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},p.prototype.formatError=function(t,n){var i=this.buffer;if(typeof i=="string"){var a=i.split(`
`).slice(Math.max(0,this.line-5),this.line),u=i.indexOf(`
`,this.index);u===-1&&(u=i.length);var l=this.index-this.lastLineBreak,h=String(this.line).length;return n+=" at line "+this.line+" col "+l+`:

`,n+=a.map(function(d,m){return f(this.line-a.length+m+1,h)+" "+d},this).join(`
`),n+=`
`+f("",h+l)+`^
`,n}else return n+" at index "+(this.index-1);function f(d,m){var y=String(d);return Array(m-y.length+1).join(" ")+y}};function c(t,n,i){if(t instanceof r)var a=t,i=n;else var a=r.fromCompiled(t,n);this.grammar=a,this.options={keepHistory:!1,lexer:a.lexer||new p};for(var u in i||{})this.options[u]=i[u];this.lexer=this.options.lexer,this.lexerState=void 0;var l=new e(a,0),h=this.table=[l];l.wants[a.start]=[],l.predict(a.start),l.process(),this.current=0}c.fail={},c.prototype.feed=function(t){var n=this.lexer;n.reset(t,this.lexerState);for(var i;;){try{if(i=n.next(),!i)break}catch(P){var h=new e(this.grammar,this.current+1);this.table.push(h);var a=new Error(this.reportLexerError(P));throw a.offset=this.current,a.token=P.token,a}var u=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var l=this.current+1,h=new e(this.grammar,l);this.table.push(h);for(var f=i.text!==void 0?i.text:i.value,d=n.constructor===p?i.value:i,m=u.scannable,y=m.length;y--;){var $=m[y],g=$.rule.symbols[$.dot];if(g.test?g.test(d):g.type?g.type===i.type:g.literal===f){var L=$.nextState({data:d,token:i,isToken:!0,reference:l-1});h.states.push(L)}}if(h.process(),h.states.length===0){var a=new Error(this.reportError(i));throw a.offset=this.current,a.token=i,a}this.options.keepHistory&&(u.lexerState=n.save()),this.current++}return u&&(this.lexerState=n.save()),this.results=this.finish(),this},c.prototype.reportLexerError=function(t){var n,i,a=t.token;return a?(n="input "+JSON.stringify(a.text[0])+" (lexer error)",i=this.lexer.formatError(a,"Syntax error")):(n="input (lexer error)",i=t.message),this.reportErrorCommon(i,n)},c.prototype.reportError=function(t){var n=(t.type?t.type+" token: ":"")+JSON.stringify(t.value!==void 0?t.value:t),i=this.lexer.formatError(t,"Syntax error");return this.reportErrorCommon(i,n)},c.prototype.reportErrorCommon=function(t,n){var i=[];i.push(t);var a=this.table.length-2,u=this.table[a],l=u.states.filter(function(f){var d=f.rule.symbols[f.dot];return d&&typeof d!="string"});if(l.length===0)i.push("Unexpected "+n+`. I did not expect any more input. Here is the state of my parse table:
`),this.displayStateStack(u.states,i);else{i.push("Unexpected "+n+`. Instead, I was expecting to see one of the following:
`);var h=l.map(function(f){return this.buildFirstStateStack(f,[])||[f]},this);h.forEach(function(f){var d=f[0],m=d.rule.symbols[d.dot],y=this.getSymbolDisplay(m);i.push("A "+y+" based on:"),this.displayStateStack(f,i)},this)}return i.push(""),i.join(`
`)},c.prototype.displayStateStack=function(t,n){for(var i,a=0,u=0;u<t.length;u++){var l=t[u],h=l.rule.toString(l.dot);h===i?a++:(a>0&&n.push("    ^ "+a+" more lines identical to this"),a=0,n.push("    "+h)),i=h}},c.prototype.getSymbolDisplay=function(t){return b(t)},c.prototype.buildFirstStateStack=function(t,n){if(n.indexOf(t)!==-1)return null;if(t.wantedBy.length===0)return[t];var i=t.wantedBy[0],a=[t].concat(n),u=this.buildFirstStateStack(i,a);return u===null?null:[t].concat(u)},c.prototype.save=function(){var t=this.table[this.current];return t.lexerState=this.lexerState,t},c.prototype.restore=function(t){var n=t.index;this.current=n,this.table[n]=t,this.table.splice(n+1),this.lexerState=t.lexerState,this.results=this.finish()},c.prototype.rewind=function(t){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[t])},c.prototype.finish=function(){var t=[],n=this.grammar.start,i=this.table[this.table.length-1];return i.states.forEach(function(a){a.rule.name===n&&a.dot===a.rule.symbols.length&&a.reference===0&&a.data!==c.fail&&t.push(a)}),t.map(function(a){return a.data})};function b(t){var n=typeof t;if(n==="string")return t;if(n==="object"){if(t.literal)return JSON.stringify(t.literal);if(t instanceof RegExp)return"character matching "+t;if(t.type)return t.type+" token";if(t.test)return"token matching "+String(t.test);throw new Error("Unknown symbol type: "+t)}}function v(t){var n=typeof t;if(n==="string")return t;if(n==="object"){if(t.literal)return JSON.stringify(t.literal);if(t instanceof RegExp)return t.toString();if(t.type)return"%"+t.type;if(t.test)return"<"+String(t.test)+">";throw new Error("Unknown symbol type: "+t)}}return{Parser:c,Grammar:r,Rule:o}})});var N=I((ie,S)=>{(function(){function o(e){return e[0]}var s={Lexer:void 0,ParserRules:[{name:"expression",symbols:["conditional"],postprocess:e=>e[0]},{name:"conditional",symbols:["disjunction","_",{literal:"?"},"_","expression","_",{literal:":"},"_","expression"],postprocess:e=>e[0]+"?"+e[4]+":"+e[8]},{name:"conditional",symbols:["disjunction"],postprocess:e=>e[0]},{name:"parens",symbols:[{literal:"("},"_","expression","_",{literal:")"}],postprocess:e=>"("+e[2]+")"},{name:"parens",symbols:["atom"],postprocess:e=>e[0]},{name:"disjunction$string$1",symbols:[{literal:"|"},{literal:"|"}],postprocess:function(r){return r.join("")}},{name:"disjunction",symbols:["disjunction","_","disjunction$string$1","_","conjunction"],postprocess:e=>e[0]+"||"+e[4]},{name:"disjunction",symbols:["conjunction"],postprocess:e=>e[0]},{name:"conjunction$string$1",symbols:[{literal:"&"},{literal:"&"}],postprocess:function(r){return r.join("")}},{name:"conjunction",symbols:["conjunction","_","conjunction$string$1","_","comparison"],postprocess:e=>e[0]+"&&"+e[4]},{name:"conjunction",symbols:["comparison"],postprocess:e=>e[0]},{name:"comparison",symbols:["comparison","_","COMPARISON_OP","_","sumcalc"],postprocess:e=>e[0]+e[2]+e[4]},{name:"comparison",symbols:["sumcalc"],postprocess:e=>e[0]},{name:"sumcalc",symbols:["sumcalc","_","SUM_OP","_","prodcalc"],postprocess:e=>e[0]+e[2]+e[4]},{name:"sumcalc",symbols:["prodcalc"],postprocess:e=>e[0]},{name:"prodcalc",symbols:["prodcalc","_","PROD_OP","_","negation"],postprocess:e=>e[0]+e[2]+e[4]},{name:"prodcalc",symbols:["negation"],postprocess:e=>e[0]},{name:"negation",symbols:[{literal:"!"},"_","negation"],postprocess:e=>"!"+e[2]},{name:"negation",symbols:["parens"],postprocess:e=>e[0]},{name:"offsetaccess",symbols:[{literal:"["},"_","expression","_",{literal:"]"}],postprocess:e=>"helper.val("+e[2]+")"},{name:"methodcall$ebnf$1",symbols:["expression"],postprocess:o},{name:"methodcall$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"methodcall$ebnf$2",symbols:[]},{name:"methodcall$ebnf$2$subexpression$1",symbols:[{literal:","},"_","expression"]},{name:"methodcall$ebnf$2",symbols:["methodcall$ebnf$2","methodcall$ebnf$2$subexpression$1"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"methodcall",symbols:["IDENTIFIER","_",{literal:"("},"_","methodcall$ebnf$1","_","methodcall$ebnf$2","_",{literal:")"}],postprocess:e=>'helper.call("'+e[0]+'", ['+(e[4]?[e[4],...e[6].map(r=>r[2])].join(","):"")+"])"},{name:"objectpath$ebnf$1",symbols:[]},{name:"objectpath$ebnf$1$subexpression$1",symbols:["nested_methodcall_or_identifier"]},{name:"objectpath$ebnf$1$subexpression$1",symbols:["offsetaccess"]},{name:"objectpath$ebnf$1",symbols:["objectpath$ebnf$1","objectpath$ebnf$1$subexpression$1"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"objectpath",symbols:["methodcall_or_identifier","objectpath$ebnf$1"],postprocess:e=>{let r=e[0]+"(ctx)";for(let p of e[1])r=p[0]+"("+r+")";return r}},{name:"nested_methodcall_or_identifier",symbols:[{literal:"."},"methodcall_or_identifier"],postprocess:e=>e[1]},{name:"methodcall_or_identifier",symbols:["methodcall"],postprocess:e=>e[0]},{name:"methodcall_or_identifier",symbols:["identifier"],postprocess:e=>e[0]},{name:"identifier",symbols:["IDENTIFIER"],postprocess:e=>'helper.val("'+e[0]+'")'},{name:"atom",symbols:["objectpath"],postprocess:e=>e[0]},{name:"atom",symbols:["NUMBER"],postprocess:e=>e[0]},{name:"atom",symbols:["dqstring"],postprocess:e=>e[0]},{name:"atom",symbols:["sqstring"],postprocess:e=>e[0]},{name:"IDENTIFIER$ebnf$1",symbols:[]},{name:"IDENTIFIER$ebnf$1",symbols:["IDENTIFIER$ebnf$1",/[a-zA-Z_0-9]/],postprocess:function(r){return r[0].concat([r[1]])}},{name:"IDENTIFIER",symbols:[/[a-zA-Z_]/,"IDENTIFIER$ebnf$1"],postprocess:e=>e[0]+e[1].join("")},{name:"NUMBER$ebnf$1",symbols:[{literal:"-"}],postprocess:o},{name:"NUMBER$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"NUMBER$ebnf$2",symbols:[/[0-9]/]},{name:"NUMBER$ebnf$2",symbols:["NUMBER$ebnf$2",/[0-9]/],postprocess:function(r){return r[0].concat([r[1]])}},{name:"NUMBER",symbols:["NUMBER$ebnf$1","NUMBER$ebnf$2"],postprocess:e=>(e[0]||"")+e[1].join("")},{name:"COMPARISON_OP$string$1",symbols:[{literal:"="},{literal:"="}],postprocess:function(r){return r.join("")}},{name:"COMPARISON_OP",symbols:["COMPARISON_OP$string$1"],postprocess:e=>e[0]},{name:"COMPARISON_OP$string$2",symbols:[{literal:"!"},{literal:"="}],postprocess:function(r){return r.join("")}},{name:"COMPARISON_OP",symbols:["COMPARISON_OP$string$2"],postprocess:e=>e[0]},{name:"COMPARISON_OP$string$3",symbols:[{literal:"<"},{literal:"="}],postprocess:function(r){return r.join("")}},{name:"COMPARISON_OP",symbols:["COMPARISON_OP$string$3"],postprocess:e=>e[0]},{name:"COMPARISON_OP$string$4",symbols:[{literal:">"},{literal:"="}],postprocess:function(r){return r.join("")}},{name:"COMPARISON_OP",symbols:["COMPARISON_OP$string$4"],postprocess:e=>e[0]},{name:"COMPARISON_OP",symbols:[{literal:"<"}],postprocess:e=>e[0]},{name:"COMPARISON_OP",symbols:[{literal:">"}],postprocess:e=>e[0]},{name:"SUM_OP",symbols:[{literal:"+"}],postprocess:e=>e[0]},{name:"SUM_OP",symbols:[{literal:"-"}],postprocess:e=>e[0]},{name:"PROD_OP",symbols:[{literal:"*"}],postprocess:e=>e[0]},{name:"PROD_OP",symbols:[{literal:"/"}],postprocess:e=>e[0]},{name:"PROD_OP",symbols:[{literal:"%"}],postprocess:e=>e[0]},{name:"dqstring$ebnf$1",symbols:[]},{name:"dqstring$ebnf$1",symbols:["dqstring$ebnf$1","dstrchar"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"dqstring",symbols:[{literal:'"'},"dqstring$ebnf$1",{literal:'"'}],postprocess:e=>'"'+e[1].join("")+'"'},{name:"dstrchar",symbols:[/[^\\"\n]/],postprocess:o},{name:"dstrchar",symbols:[{literal:"\\"},"strescape"],postprocess:e=>e.join("")},{name:"sqstring$ebnf$1",symbols:[]},{name:"sqstring$ebnf$1",symbols:["sqstring$ebnf$1","sstrchar"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"sqstring",symbols:[{literal:"'"},"sqstring$ebnf$1",{literal:"'"}],postprocess:e=>"'"+e[1].join("")+"'"},{name:"sstrchar",symbols:[/[^\\'\n]/],postprocess:o},{name:"sstrchar",symbols:[{literal:"\\"},"strescape"],postprocess:e=>e.join("")},{name:"strescape",symbols:[/["'\\\/bfnrt]/],postprocess:o},{name:"strescape",symbols:[{literal:"u"},/[a-fA-F0-9]/,/[a-fA-F0-9]/,/[a-fA-F0-9]/,/[a-fA-F0-9]/],postprocess:e=>e.join("")},{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:["_$ebnf$1",/[\s]/],postprocess:function(r){return r[0].concat([r[1]])}},{name:"_",symbols:["_$ebnf$1"],postprocess:e=>null}],ParserStart:"expression"};typeof S<"u"&&typeof S.exports<"u"?S.exports=s:window.grammar=s})()});var _=w(C(),1),A=w(N(),1),Z=_.default.Grammar.fromCompiled(A.default),K={val(o){return s=>s&&s[o]},call(o,s){return e=>e&&typeof e[o]=="function"?e[o].apply(this,s):void 0}};function Q(o){let s=new _.default.Parser(Z);if(s.feed(o),!s.results||s.results.length===0)throw new Error("empty expression");return s.results[0]}function O(o){let e=`return ${Q(o)};`,r=new Function("helper","ctx",e);return p=>r(K,p)}function W(o,s){let e={},r;for(let p=0;p<o.elements.length;p++){let c=o.elements[p];if(!c.name||c.type==="reset"||c.type==="submit"||c.type==="button")continue;let[b,v]=X(s,c.name);b.substr(0,2)!=="__"&&(c.type==="select-multiple"?r=c.options.filter(t=>t.selected).map(t=>t.value):c.type==="checkbox"?r=c.checked:c.type==="radio"?c.checked?r=c.value:typeof e[b]>"u"&&(r=null):r=c.value,v?(e[b]=e[b]||[],r&&e[b].push(r)):e[b]=r)}return e}function X(o,s){if(s.indexOf("[originallySubmittedResource][__identity]")!==-1&&(s=s.substr(0,s.length-41)),s.indexOf("[resource]")!==-1&&(s=s.substr(0,s.length-10)),s.indexOf(o+"[")===0){s=s.substr(o.length+1);let e=s.indexOf("]");s=s.substr(0,e)+s.substr(e+1)}return s.indexOf("[")!==-1?(s=s.substr(0,s.indexOf("[")),[s,!0]):[s,!1]}var M=W;var D="[data-display-condition]",j="input, select, textarea";function Y(o){let s=re(o);k(o,s);let e=function(){k(o,s)};return o.addEventListener("change",e),function(){o.removeEventListener("change",e)}}function k(o,s){let e=se(o);o.querySelectorAll(D).forEach(p=>{let c=p.getAttribute("data-display-condition");console.log(p);let b=s[c];if(typeof b>"u")return;let v=b(e);console.log("evaluatedCondition: "+v),v?(console.log("show element"),ee(p)):te(p)});let r=new CustomEvent("condition-done",{bubbles:!0});o.dispatchEvent(r)}function B(o,s=!0){let e=o.querySelectorAll(j);o.matches&&o.matches(j)&&e.push(o),o.msMatchesSelector&&o.msMatchesSelector(j)&&e.push(o),[...e].forEach(r=>{s?r.dataset.disabledByDisplayCondition&&(r.removeAttribute("disabled"),delete r.dataset.disabledByDisplayCondition):r.hasAttribute("disabled")||(r.dataset.disabledByDisplayCondition=!0,r.setAttribute("disabled",""))})}function ee(o){if(o.classList.remove("js-hidden"),!o.closest(".js-hidden")){B(o,!0);let e=new CustomEvent("condition-show",{bubbles:!0});o.dispatchEvent(e)}}function te(o){o.classList.add("js-hidden"),B(o,!1);let s=new CustomEvent("condition-hide",{bubbles:!0});o.dispatchEvent(s)}function se(o){let s={},e=o.getAttribute("data-form-state");e&&(s=JSON.parse(e)),console.log(o);let r=M(o,`${o.id}`);console.log(r);for(let p in r)r.hasOwnProperty(p)&&(s[p]=r[p]);return s}function re(o){let s={};return o.querySelectorAll(D).forEach(e=>{let r=e.getAttribute("data-display-condition");s[r]=O(r)}),s}var F=Y;function ne(o="form.dynamic-form"){let s=[];return document.querySelectorAll(o).forEach(e=>{let r=F(e);s.push(r)}),function(){s.forEach(r=>r())}}var q=ne;function U(){q()}U();})();
//# sourceMappingURL=main.js.map
